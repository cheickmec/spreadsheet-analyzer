{# Partial template for formatting errors and warnings #}

{% macro format_error(error) %}
ERROR: {{ error.message }}
  Location: {{ error.location | default('Unknown') }}
  Type: {{ error.type | default('General') }}
  {% if error.suggestion %}
  Suggestion: {{ error.suggestion }}
  {% endif %}
{% endmacro %}

{% macro format_warning(warning) %}
WARNING: {{ warning.message }}
  {% if warning.severity %}Severity: {{ warning.severity }}{% endif %}
  {% if warning.affected_cells %}Affected: {{ warning.affected_cells | join(', ') }}{% endif %}
{% endmacro %}

{% macro format_validation_result(result) %}
{% if result.passed %}
✓ PASS: {{ result.description }}
{% else %}
✗ FAIL: {{ result.description }}
  {% if result.expected %}Expected: {{ result.expected }}{% endif %}
  {% if result.actual %}Actual: {{ result.actual }}{% endif %}
  {% if result.details %}Details: {{ result.details }}{% endif %}
{% endif %}
{% endmacro %}

{% macro format_exception_safely(exception_info) %}
An error occurred during analysis:
  Type: {{ exception_info.type | default('Unknown') }}
  Message: {{ exception_info.message | truncate(200) }}

Please try:
  1. Verify the file is accessible
  2. Check data formats and types
  3. Ensure formulas are valid
  4. Consider using error handling in your code
{% endmacro %}
